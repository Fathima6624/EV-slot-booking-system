{% extends "base.html" %}
{% load tz %}

{% block content %}
<style>
    .container {
        max-width: 1000px;
        margin: 100px auto;
        padding: 0 20px;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .header h2 {
        font-size: 28px;
        font-weight: 800;
    }

    .btn-primary {
        background: #0f766e;
        color: #fff;
        padding: 12px 20px;
        border-radius: 12px;
        text-decoration: none;
        font-weight: 600;
    }

    .slot-card {
        background: #fff;
        padding: 22px;
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
    }

    .slot-info p {
        margin: 4px 0;
        font-size: 15px;
    }

    .badge {
        padding: 6px 14px;
        border-radius: 999px;
        font-size: 13px;
        font-weight: 600;
    }

    .available {
        background: #dcfce7;
        color: #166534;
    }

    .booked {
        background: #fee2e2;
        color: #991b1b;
    }

    .inactive {
        background: #e5e7eb;
        color: #374151;
    }

    .expired {
        background: #f1f5f9;
        color: #64748b;
    }
</style>

<div class="container">

    <div class="header">
        <h2>
            Slots · CP-{{ charging_point.point_number }}
            ({{ charging_point.power_kw }} kW)
        </h2>

        <a href="{% url 'add_slot' charging_point.id %}"
           class="btn-primary">
            + Add Slot
        </a>
    </div>

    {% for slot in slots %}
        <div class="slot-card">
            <div class="slot-info">
                <p>
                    <strong>
                        {{ slot.start_at|localtime|date:"d M Y, h:i A" }}
                        –
                        {{ slot.end_at|localtime|time:"h:i A" }}
                    </strong>
                </p>

                {# ===== SLOT STATUS LOGIC ===== #}
                {% if slot.end_at <= now %}
                    <span class="badge expired">Expired</span>

                {% elif not slot.is_active %}
                    <span class="badge inactive">Inactive</span>

                {% elif slot.is_booked %}
                    <span class="badge booked">Booked</span>

                {% else %}
                    <span class="badge available">Available</span>
                {% endif %}
            </div>

           <div class="actions">
    {% if slot.end_at <= now %}
        <span class="badge inactive">Expired</span>
    {% elif slot.is_active %}
        <span class="badge available">Active</span>
    {% else %}
        <span class="badge inactive">Inactive</span>
    {% endif %}
</div>

        </div>
    {% empty %}
        <p>No slots added yet.</p>
    {% endfor %}

</div>
{% endblock %}
